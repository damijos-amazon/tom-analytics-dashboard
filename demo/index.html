<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>TOM Analytics Dashboard - Demo</title>
    <script>
        // Authentication check - redirect to login if not authenticated
        (function() {
            // Check if Supabase is configured
            const supabaseUrl = localStorage.getItem('supabase_url');
            const supabaseKey = localStorage.getItem('supabase_anon_key');
            
            if (supabaseUrl && supabaseKey) {
                // Supabase is configured - check authentication
                const sessionData = sessionStorage.getItem('supabase.auth.token');
                if (!sessionData) {
                    console.log('üîí Not authenticated - redirecting to login');
                    window.location.href = 'login.html';
                    return;
                }
            } else {
                console.log('‚ö†Ô∏è Supabase not configured - running in demo mode');
            }
        })();
        
        // Automatic cache busting - generates unique timestamp for each page load
        var cacheBuster = new Date().getTime();
        // Force reload on version change
        var APP_VERSION = '3.0.0';
        var storedVersion = localStorage.getItem('appVersion');
        if (storedVersion !== APP_VERSION) {
            console.log('üîÑ App updated to version ' + APP_VERSION + ' - Clearing cache');
            localStorage.setItem('appVersion', APP_VERSION);
            // Force reload once
            if (!sessionStorage.getItem('reloaded')) {
                sessionStorage.setItem('reloaded', 'true');
                window.location.reload(true);
            }
        }
    </script>
    <link rel="stylesheet" href="css/styles.css?v=1.0">
    <link rel="stylesheet" href="css/nav-styles.css?v=1.0">
    <link rel="stylesheet" href="css/config-modal.css?v=1.0">
</head>
<body>
    <!-- Simple Working Navigation -->
    <div id="simpleNav" style="position: fixed; top: 20px; left: 20px; z-index: 10000;">
        <button onclick="toggleNav()" style="background: #FF9900; border: none; padding: 15px; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;">‚ò∞ Navigation</button>
        <div id="navPanel" style="display: none; position: absolute; top: 60px; left: 0; width: 300px; max-height: 80vh; overflow-y: auto; background: #333; color: white; border-radius: 8px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);">
            <h3 style="margin: 0 0 15px 0; color: #FFD700;">TOM Team Navigation</h3>
            <div style="margin-bottom: 15px;">
                <div onclick="toggleBenchmarks()" style="cursor: pointer; padding: 10px; background: #444; border-radius: 5px; margin-bottom: 10px;">
                    üìä Benchmarks <span id="arrow">‚ñº</span>
                </div>
                <div id="benchmarkList" style="display: none; margin-left: 20px;">
                    <a href="#vti-compliance" onclick="goTo('#vti-compliance')" style="display: block; color: #FFD700; text-decoration: none; padding: 8px 0; border-bottom: 1px solid #555;">üìà VTI Compliance</a>
                    <a href="#vti-dpmo" onclick="goTo('#vti-dpmo')" style="display: block; color: #FFD700; text-decoration: none; padding: 8px 0; border-bottom: 1px solid #555;">üìâ VTI DPMO</a>
                    <a href="#ta-idle-time" onclick="goTo('#ta-idle-time')" style="display: block; color: #FFD700; text-decoration: none; padding: 8px 0; border-bottom: 1px solid #555;">‚è±Ô∏è TA Idle Time</a>
                    <a href="#seal-validation" onclick="goTo('#seal-validation')" style="display: block; color: #FFD700; text-decoration: none; padding: 8px 0; border-bottom: 1px solid #555;">‚úÖ Seal Validation</a>
                    <a href="#ppo-compliance" onclick="goTo('#ppo-compliance')" style="display: block; color: #FFD700; text-decoration: none; padding: 8px 0; border-bottom: 1px solid #555;">üìã PPO Compliance</a>
                    <a href="#andon-response" onclick="goTo('#andon-response')" style="display: block; color: #FFD700; text-decoration: none; padding: 8px 0;">üö® Andon Response</a>
                </div>
            </div>
            <a href="#leaderboard" onclick="goTo('#leaderboard')" style="display: block; color: #FFD700; text-decoration: none; padding: 10px; background: #444; border-radius: 5px; margin-bottom: 10px;">üèÜ TOM Team Leaderboard</a>

            <div onclick="openShoutOutModal()" style="cursor: pointer; padding: 10px; background: #067D62; border-radius: 5px; color: white; font-weight: bold; text-align: left; margin-bottom: 10px;">
                üéâ TOM Shout Outs
            </div>
            <div onclick="openVerbiageGenerator()" style="cursor: pointer; padding: 10px; background: linear-gradient(135deg, #9B59B6 0%, #8E44AD 100%); border: 2px solid #FFD700; border-radius: 5px; color: white; font-weight: bold; text-align: left; margin-bottom: 10px; box-shadow: 0 4px 15px rgba(155,89,182,0.4);">
                ‚ú® Shout Out Generator
            </div>
            <div onclick="openCertificateModalV2()" style="cursor: pointer; padding: 10px; background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); border: 2px solid #FF9900; border-radius: 5px; color: #232F3E; font-weight: bold; text-align: left; margin-bottom: 10px; box-shadow: 0 4px 15px rgba(255,215,0,0.4);">
                üèÜ Achievement Certificates
            </div>
            <div onclick="document.getElementById('simpleEmployeeModal').style.display='block';" style="cursor: pointer; padding: 10px; background: #FF9900; border-radius: 5px; color: white; font-weight: bold; text-align: left; margin-bottom: 10px;">
                üë• Employee Management
            </div>
            <a href="supabase-config.html" style="display: block; cursor: pointer; padding: 10px; background: #2196F3; border-radius: 5px; color: white; font-weight: bold; text-align: left; text-decoration: none;">
                üîß Database Configuration
            </a>
        </div>
    </div>

    <!-- Quick Scroll Buttons -->
    <div class="scroll-buttons">
        <button class="scroll-btn scroll-top" onclick="scrollToTop()" title="Go to Top">
            <span>‚Üë</span>
        </button>
        <button class="scroll-btn scroll-bottom" onclick="scrollToBottom()" title="Go to Bottom">
            <span>‚Üì</span>
        </button>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header" id="top">
            <div class="amazon-logo">
                <img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg" alt="Amazon" class="logo">
            </div>
            <h1 class="title">TOM Analytics Dashboard</h1>
            <h2 class="subtitle">Employee Recognition & Appreciation System</h2>
            
            <!-- User Info Section (shown when authenticated) -->
            <div id="userInfoSection" style="display: none; position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.1); padding: 10px 20px; border-radius: 8px; backdrop-filter: blur(10px);">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="text-align: right;">
                        <div id="userEmail" style="color: #FFD700; font-weight: bold; font-size: 14px;"></div>
                        <div id="userRole" style="color: #FFF; font-size: 12px; opacity: 0.8;"></div>
                    </div>
                    <button onclick="logout()" style="background: #FF9900; border: none; padding: 8px 16px; border-radius: 5px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s;">
                        Logout
                    </button>
                </div>
            </div>
        </header>

        <!-- File Upload Section -->
        <section class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-content">
                    <div class="upload-icon">üìÅ</div>
                    <p>Drag & Drop Excel/CSV/JSON files here</p>
                    <p class="upload-subtext">or click to browse</p>
                    <input type="file" id="fileInput" multiple accept=".xlsx,.csv,.json" hidden>
                    <input type="file" id="restoreInput" accept=".json" hidden>
                </div>
            </div>
            
            <div class="upload-controls">
                <button class="btn btn-success" onclick="exportAllData()">üì¶ Export All Data</button>
                <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
                <button class="btn btn-info" onclick="toggleFileNamingLegend()">üìã File Naming Guide</button>
                <button class="btn btn-primary" onclick="if(window.configModal) configModal.show()">‚öôÔ∏è Manage Tables</button>
            </div>

            <!-- File Naming Legend -->
            <div class="file-naming-legend" id="fileNamingLegend" style="display: none;">
                <h3>üìã File Naming Structure Guide</h3>
                <div class="legend-content">
                    <div class="legend-section">
                        <h4>üéØ VTI Compliance</h4>
                        <ul>
                            <li><code>prior-vti.csv</code> or <code>prior-vti.xlsx</code></li>
                            <li><code>current-vti.csv</code> or <code>current-vti.xlsx</code></li>
                        </ul>
                    </div>
                    
                    <div class="legend-section">
                        <h4>üìä VTI DPMO</h4>
                        <ul>
                            <li><code>prior-vti-dpmo.csv</code> or <code>prior-vti-dpmo.xlsx</code></li>
                            <li><code>current-vti-dpmo.csv</code> or <code>current-vti-dpmo.xlsx</code></li>
                        </ul>
                    </div>
                    
                    <div class="legend-section">
                        <h4>‚è±Ô∏è TA Idle Time</h4>
                        <ul>
                            <li><code>prior-ta-idle-time.csv</code> or <code>prior-ta-idle-time.xlsx</code></li>
                            <li><code>current-ta-idle-time.csv</code> or <code>current-ta-idle-time.xlsx</code></li>
                        </ul>
                    </div>
                    
                    <div class="legend-section">
                        <h4>‚úÖ Seal Validation Accuracy</h4>
                        <ul>
                            <li><code>prior-seal-validation.csv</code> or <code>prior-seal-validation.xlsx</code></li>
                            <li><code>current-seal-validation.csv</code> or <code>current-seal-validation.xlsx</code></li>
                        </ul>
                    </div>
                    
                    <div class="legend-section">
                        <h4>üìã PPO Compliance</h4>
                        <ul>
                            <li><code>prior-ppo-compliance.csv</code> or <code>prior-ppo-compliance.xlsx</code></li>
                            <li><code>current-ppo-compliance.csv</code> or <code>current-ppo-compliance.xlsx</code></li>
                        </ul>
                    </div>
                    
                    <div class="legend-section">
                        <h4>üö® Andon Response Time</h4>
                        <ul>
                            <li><code>prior-andon-response-time.csv</code> or <code>prior-andon-response-time.xlsx</code></li>
                            <li><code>current-andon-response-time.csv</code> or <code>current-andon-response-time.xlsx</code></li>
                        </ul>
                    </div>
                </div>
                <div class="legend-footer">
                    <p><strong>üí° Tip:</strong> Files are automatically routed to the correct table based on their exact filename. Both CSV and Excel formats are supported.</p>
                </div>
            </div>

        </section>

        <!-- VTI Compliance Table -->
        <section class="table-section" id="vti-compliance">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 class="table-title" style="margin: 0;">VTI Compliance</h2>
                <button class="manual-refresh-btn" onclick="manualRefreshTable('tableBody', 'podium1')" title="Refresh Table & Podium">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
            <div class="table-controls">
                <div class="table-actions">
                    <button class="btn btn-danger" onclick="clearData()">Clear Data</button>
                    <button class="btn btn-secondary" onclick="openBenchmarkModal('vti-compliance')">Edit Benchmark</button>
                    <button id="autoRefreshBtn_tableBody" class="btn btn-info" onclick="toggleAutoRefresh('tableBody')" style="transition: all 0.3s;">üîÑ Auto-Refresh: <span style="color: #ccc;">OFF</span></button>
                </div>
                <div class="export-controls">
                    <button class="btn btn-export" onclick="exportExcel()">Export Excel</button>
                    <button class="btn btn-export" onclick="exportCSV()">Export CSV</button>
                    <button class="btn btn-export" onclick="exportJSON()">Export JSON</button>
                </div>
            </div>

            <div class="table-container">
                <table class="compliance-table" id="complianceTable">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Associate Name</th>
                            <th>Prior Month %</th>
                            <th>Current Month %</th>
                            <th>Change %</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Table will be populated when files are uploaded -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Top 3 Performers Podium -->
        <section class="podium-section">
            <h2 class="podium-title">Top 3 Performers</h2>
            <div class="podium" id="podium1">
                <div class="podium-place second">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-silver">ü•à</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place first">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-gold">üèÜ</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place third">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-bronze">ü•â</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
            </div>
        </section>

        <!-- Section Divider -->
        <div class="section-divider"></div>

        <!-- Table 2 -->
        <section class="table-section" id="vti-dpmo">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 class="table-title" style="margin: 0;">VTI DPMO</h2>
                <button class="manual-refresh-btn" onclick="manualRefreshTable('tableBody2', 'podium2')" title="Refresh Table & Podium">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
            <div class="table-controls">
                <div class="table-actions">
                    <button class="btn btn-danger" onclick="clearData2()">Clear Data</button>
                    <button class="btn btn-secondary" onclick="openBenchmarkModal('vti-dpmo')">Edit Benchmark</button>
                    <button id="autoRefreshBtn_tableBody2" class="btn btn-info" onclick="toggleAutoRefresh('tableBody2')" style="transition: all 0.3s;">üîÑ Auto-Refresh: <span style="color: #ccc;">OFF</span></button>
                </div>
                <div class="export-controls">
                    <button class="btn btn-export" onclick="exportExcel2()">Export Excel</button>
                    <button class="btn btn-export" onclick="exportCSV2()">Export CSV</button>
                    <button class="btn btn-export" onclick="exportJSON2()">Export JSON</button>
                </div>
            </div>

            <div class="table-container">
                <table class="compliance-table" id="complianceTable2">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Associate Name</th>
                            <th>Prior Month</th>
                            <th>Current Month</th>
                            <th>Change %</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody2">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Top 3 Performers Podium 2 -->
        <section class="podium-section">
            <h2 class="podium-title">Top 3 Performers</h2>
            <div class="podium" id="podium2">
                <div class="podium-place second">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-silver">ü•à</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place first">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-gold">üèÜ</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place third">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-bronze">ü•â</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
            </div>
        </section>

        <!-- Section Divider -->
        <div class="section-divider"></div>

        <!-- Table 3 -->
        <section class="table-section" id="ta-idle-time">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 class="table-title" style="margin: 0;">TA Idle Time</h2>
                <button class="manual-refresh-btn" onclick="manualRefreshTable('tableBody3', 'podium3')" title="Refresh Table & Podium">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
            <div class="table-controls">
                <div class="table-actions">
                    <button class="btn btn-danger" onclick="clearData3()">Clear Data</button>
                    <button class="btn btn-secondary" onclick="openTAIdleBenchmarkModal()">Edit Benchmark</button>
                    <button id="autoRefreshBtn_tableBody3" class="btn btn-info" onclick="toggleAutoRefresh('tableBody3')" style="transition: all 0.3s;">üîÑ Auto-Refresh: <span style="color: #ccc;">OFF</span></button>
                </div>
                <div class="export-controls">
                    <button class="btn btn-export" onclick="exportExcel3()">Export Excel</button>
                    <button class="btn btn-export" onclick="exportCSV3()">Export CSV</button>
                    <button class="btn btn-export" onclick="exportJSON3()">Export JSON</button>
                </div>
            </div>

            <div class="table-container">
                <table class="compliance-table" id="complianceTable3">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Associate Name</th>
                            <th>Prior Month (min)</th>
                            <th>Current Month (min)</th>
                            <th>Change (min)</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody3">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Top 3 Performers Podium 3 -->
        <section class="podium-section">
            <h2 class="podium-title">Top 3 Performers</h2>
            <div class="podium" id="podium3">
                <div class="podium-place second">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-silver">ü•à</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place first">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-gold">üèÜ</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place third">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-bronze">ü•â</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
            </div>
        </section>

        <!-- Section Divider -->
        <div class="section-divider"></div>

        <!-- Table 4 -->
        <section class="table-section" id="seal-validation">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 class="table-title" style="margin: 0;">Seal Validation Accuracy %</h2>
                <button class="manual-refresh-btn" onclick="manualRefreshTable('tableBody4', 'podium4')" title="Refresh Table & Podium">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
            <div class="table-controls">
                <div class="table-actions">
                    <button class="btn btn-danger" onclick="clearData4()">Clear Data</button>
                    <button class="btn btn-secondary" onclick="openBenchmarkModal('seal-validation')">Edit Benchmark</button>
                    <button id="autoRefreshBtn_tableBody4" class="btn btn-info" onclick="toggleAutoRefresh('tableBody4')" style="transition: all 0.3s;">üîÑ Auto-Refresh: <span style="color: #ccc;">OFF</span></button>
                </div>
                <div class="export-controls">
                    <button class="btn btn-export" onclick="exportExcel4()">Export Excel</button>
                    <button class="btn btn-export" onclick="exportCSV4()">Export CSV</button>
                    <button class="btn btn-export" onclick="exportJSON4()">Export JSON</button>
                </div>
            </div>

            <div class="table-container">
                <table class="compliance-table" id="complianceTable4">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Associate Name</th>
                            <th>Prior Month %</th>
                            <th>Current Month %</th>
                            <th>Change %</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody4">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Top 3 Performers Podium 4 -->
        <section class="podium-section">
            <h2 class="podium-title">Top 3 Performers</h2>
            <div class="podium" id="podium4">
                <div class="podium-place second">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-silver">ü•à</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place first">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-gold">üèÜ</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place third">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-bronze">ü•â</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
            </div>
        </section>

        <!-- Section Divider -->
        <div class="section-divider"></div>

        <!-- Table 5 -->
        <section class="table-section" id="ppo-compliance">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 class="table-title" style="margin: 0;">PPO Compliance</h2>
                <button class="manual-refresh-btn" onclick="manualRefreshTable('tableBody5', 'podium5')" title="Refresh Table & Podium">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
            <div class="table-controls">
                <div class="table-actions">
                    <button class="btn btn-danger" onclick="clearData5()">Clear Data</button>
                    <button class="btn btn-secondary" onclick="openBenchmarkModal('ppo-compliance')">Edit Benchmark</button>
                    <button id="autoRefreshBtn_tableBody5" class="btn btn-info" onclick="toggleAutoRefresh('tableBody5')" style="transition: all 0.3s;">üîÑ Auto-Refresh: <span style="color: #ccc;">OFF</span></button>
                </div>
                <div class="export-controls">
                    <button class="btn btn-export" onclick="exportExcel5()">Export Excel</button>
                    <button class="btn btn-export" onclick="exportCSV5()">Export CSV</button>
                    <button class="btn btn-export" onclick="exportJSON5()">Export JSON</button>
                </div>
            </div>

            <div class="table-container">
                <table class="compliance-table" id="complianceTable5">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Associate Name</th>
                            <th>Prior Month</th>
                            <th>Current Month</th>
                            <th>Change %</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody5">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Top 3 Performers Podium 5 -->
        <section class="podium-section">
            <h2 class="podium-title">Top 3 Performers</h2>
            <div class="podium" id="podium5">
                <div class="podium-place second">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-silver">ü•à</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place first">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-gold">üèÜ</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place third">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-bronze">ü•â</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
            </div>
        </section>

        <!-- Section Divider -->
        <div class="section-divider"></div>

        <!-- Table 6 -->
        <section class="table-section" id="andon-response">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 class="table-title" style="margin: 0;">Andon Response Time</h2>
                <button class="manual-refresh-btn" onclick="manualRefreshTable('tableBody6', 'podium6')" title="Refresh Table & Podium">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
            <div class="table-controls">
                <div class="table-actions">
                    <button class="btn btn-danger" onclick="clearData6()">Clear Data</button>
                    <button class="btn btn-secondary" onclick="openBenchmarkModal('andon-response')">Edit Benchmark</button>
                    <button id="autoRefreshBtn_tableBody6" class="btn btn-info" onclick="toggleAutoRefresh('tableBody6')" style="transition: all 0.3s;">üîÑ Auto-Refresh: <span style="color: #ccc;">OFF</span></button>
                </div>
                <div class="export-controls">
                    <button class="btn btn-export" onclick="exportExcel6()">Export Excel</button>
                    <button class="btn btn-export" onclick="exportCSV6()">Export CSV</button>
                    <button class="btn btn-export" onclick="exportJSON6()">Export JSON</button>
                </div>
            </div>

            <div class="table-container">
                <table class="compliance-table" id="complianceTable6">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Associate Name</th>
                            <th>Prior Month (min)</th>
                            <th>Current Month (min)</th>
                            <th>Change (min)</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody6">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Top 3 Performers Podium 6 -->
        <section class="podium-section">
            <h2 class="podium-title">Top 3 Performers</h2>
            <div class="podium" id="podium6">
                <div class="podium-place second">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-silver">ü•à</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place first">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-gold">üèÜ</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place third">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-bronze">ü•â</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
            </div>
        </section>

        <!-- Section Divider -->
        <div class="section-divider"></div>

        <!-- TOM Team Leaderboard -->
        <section class="table-section" id="leaderboard">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 class="table-title" style="margin: 0;">TOM Team Leaderboard</h2>
                <button class="manual-refresh-btn" onclick="manualRefreshLeaderboard()" title="Refresh Leaderboard">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
            </div>
            <div class="table-controls">
                <div class="table-actions">
                    <button class="btn btn-danger" onclick="clearLeaderboard()">Clear Data</button>
                    <button id="autoRefreshBtn_leaderboardBody" class="btn btn-info" onclick="toggleAutoRefresh('leaderboardBody')" style="transition: all 0.3s;">üîÑ Auto-Refresh: <span style="color: #ccc;">OFF</span></button>
                </div>
                <div class="export-controls">
                    <button class="btn btn-export" onclick="exportLeaderboardExcel()">Export Excel</button>
                    <button class="btn btn-export" onclick="exportLeaderboardCSV()">Export CSV</button>
                    <button class="btn btn-export" onclick="exportLeaderboardJSON()">Export JSON</button>
                </div>
            </div>

            <div class="table-container">
                <table class="compliance-table" id="leaderboardTable">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Associate Name</th>
                            <th>Performance</th>
                            <th>Improvement</th>
                            <th>Recognition</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody">
                    </tbody>
                </table>
            </div>
            
            <!-- Legend -->
            <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 153, 0, 0.3); border-radius: 8px; padding: 15px; margin-top: 20px;">
                <h4 style="color: #FFD700; margin: 0 0 10px 0; font-size: 14px;">üìä How Rankings Work</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 13px; color: #ccc;">
                    <div>
                        <strong style="color: #FF9900;">Performance Score:</strong> Combined score based on current performance + improvement across all tables.
                        <div style="margin-top: 5px; font-size: 12px; opacity: 0.8;">
                            ‚Ä¢ 900+ = Outstanding<br>
                            ‚Ä¢ 850-899 = Excellent<br>
                            ‚Ä¢ 800-849 = Very Good<br>
                            ‚Ä¢ 700-799 = Good<br>
                            ‚Ä¢ 600-699 = Satisfactory<br>
                            ‚Ä¢ Below 600 = Needs Improvement
                        </div>
                    </div>
                    <div>
                        <strong style="color: #4CAF50;">Improvement:</strong> Average improvement percentage across all tables. <span style="color: #4CAF50;">Green</span> = improved, <span style="color: #F44336;">Red</span> = declined.
                        <div style="margin-top: 5px; font-size: 12px; opacity: 0.8;">
                            This is the PRIMARY ranking factor. Higher improvement = better rank, regardless of performance score.
                        </div>
                    </div>
                    <div style="grid-column: 1 / -1; margin-top: 5px; padding-top: 10px; border-top: 1px solid rgba(255, 153, 0, 0.2);">
                        <strong style="color: #FFD700;">Ranking Logic:</strong> Sorted by <strong>Improvement first</strong> (most improved = #1), then by Performance score as tiebreaker. This rewards growth while recognizing excellence.
                    </div>
                </div>
            </div>
        </section>

        <!-- Top 3 Performers Podium for Leaderboard -->
        <section class="podium-section">
            <h2 class="podium-title">Top 3 Performers</h2>
            <div class="podium" id="leaderboardPodium">
                <div class="podium-place second">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-silver">ü•à</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place first">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-gold">üèÜ</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
                <div class="podium-place third">
                    <div class="performer-avatar">
                        <div class="avatar-circle">-</div>
                    </div>
                    <div class="performer-name">-</div>
                    <div class="trophy trophy-bronze">ü•â</div>
                    <div class="performer-score">- <span class="status-badge">-</span></div>
                </div>
            </div>
        </section>


    </div>

    <!-- Benchmark Modal -->
    <div id="benchmarkModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit TA Idle Time Benchmark</h3>
                <span class="close" onclick="closeTAIdleBenchmarkModal()">&times;</span>
            </div>
            <div class="modal-body">
                <label for="benchmarkValue">Benchmark Value (minutes):</label>
                <input type="number" id="benchmarkValue" placeholder="Enter benchmark in minutes" min="0" step="0.1">
                
                <label for="benchmarkDirection">Improvement Direction:</label>
                <select id="benchmarkDirection">
                    <option value="below">Below benchmark is better (lower idle time)</option>
                    <option value="above">Above benchmark is better (higher idle time)</option>
                </select>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTAIdleBenchmarkModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveTAIdleBenchmark()">Save Benchmark</button>
            </div>
        </div>
    </div>

    <!-- POWERFUL Employee Management Modal - Version 2.0 -->
    <div id="simpleEmployeeModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 99999; overflow-y: auto;">
        <div style="position: relative; max-width: 1600px; margin: 20px auto; background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); color: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 50px rgba(255,153,0,0.4); border: 3px solid #FFD700;">
            
            <!-- Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 3px solid #FFD700; padding-bottom: 20px;">
                <div>
                    <h2 style="color: #FFD700; margin: 0; font-size: 36px;">üë• Employee Management System</h2>
                    <p style="color: #FF9900; margin: 5px 0 0 0; font-size: 14px;">Manage your team ‚Ä¢ Track performance ‚Ä¢ Build culture</p>
                </div>
                <span onclick="document.getElementById('simpleEmployeeModal').style.display='none'" style="cursor: pointer; font-size: 40px; color: #FFD700; line-height: 1; transition: transform 0.2s;" onmouseover="this.style.transform='rotate(90deg)'" onmouseout="this.style.transform='rotate(0deg)'">&times;</span>
            </div>
            
            <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 30px;">
                <!-- Employee Form -->
                <div style="background: rgba(255,255,255,0.05); padding: 30px; border-radius: 15px; border: 2px solid rgba(255,153,0,0.3);">
                    <h3 id="simpleFormTitle" style="color: #FFD700; margin: 0 0 25px 0; font-size: 28px; text-align: center; background: linear-gradient(135deg, #FF9900 0%, #FF6B00 100%); padding: 15px; border-radius: 10px; box-shadow: 0 4px 15px rgba(255,153,0,0.3);">‚ûï ADD NEW EMPLOYEE</h3>
                    <form id="simpleEmployeeForm">
                        <!-- Grid for better layout -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; color: #FFD700; font-weight: bold; font-size: 14px;">Site <span style="color: #FF6B6B;">*</span></label>
                                <input type="text" id="simpleSite" required placeholder="e.g., DFW7, PHX5" style="width: 100%; padding: 14px; border: 2px solid #FF9900; border-radius: 8px; background: white; color: #232F3E; font-size: 15px; transition: all 0.3s;" onfocus="this.style.borderColor='#FFD700'; this.style.boxShadow='0 0 10px rgba(255,153,0,0.3)'" onblur="this.style.borderColor='#FF9900'; this.style.boxShadow='none'">
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 8px; color: #FFD700; font-weight: bold; font-size: 14px;">Badge ID <span id="badgeIdRequired" style="color: #FF6B6B;">*</span></label>
                                <input type="text" id="simpleBadgeId" required placeholder="Enter Badge ID" style="width: 100%; padding: 14px; border: 2px solid #FF9900; border-radius: 8px; background: white; color: #232F3E; font-size: 15px; transition: all 0.3s;" onfocus="this.style.borderColor='#FFD700'; this.style.boxShadow='0 0 10px rgba(255,153,0,0.3)'" onblur="this.style.borderColor='#FF9900'; this.style.boxShadow='none'">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; color: #FFD700; font-weight: bold; font-size: 14px;">Full Name <span id="fullNameRequired" style="color: #FF6B6B;">*</span></label>
                            <input type="text" id="simpleFullName" required placeholder="Enter Full Name" style="width: 100%; padding: 14px; border: 2px solid #FF9900; border-radius: 8px; background: white; color: #232F3E; font-size: 15px; transition: all 0.3s;" onfocus="this.style.borderColor='#FFD700'; this.style.boxShadow='0 0 10px rgba(255,153,0,0.3)'" onblur="this.style.borderColor='#FF9900'; this.style.boxShadow='none'">
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; color: #FFD700; font-weight: bold; font-size: 14px;">Username <span id="usernameRequired" style="color: #FF6B6B;">*</span></label>
                                <input type="text" id="simpleUsername" required placeholder="Enter Username" style="width: 100%; padding: 14px; border: 2px solid #FF9900; border-radius: 8px; background: white; color: #232F3E; font-size: 15px; transition: all 0.3s;" onfocus="this.style.borderColor='#FFD700'; this.style.boxShadow='0 0 10px rgba(255,153,0,0.3)'" onblur="this.style.borderColor='#FF9900'; this.style.boxShadow='none'">
                            </div>
                            
                            <div>
                                <label style="display: block; margin-bottom: 8px; color: #FFD700; font-weight: bold; font-size: 14px;">Email <span id="emailRequired" style="color: #FF6B6B;">*</span></label>
                                <input type="email" id="simpleEmail" required placeholder="Enter Email" style="width: 100%; padding: 14px; border: 2px solid #FF9900; border-radius: 8px; background: white; color: #232F3E; font-size: 15px; transition: all 0.3s;" onfocus="this.style.borderColor='#FFD700'; this.style.boxShadow='0 0 10px rgba(255,153,0,0.3)'" onblur="this.style.borderColor='#FF9900'; this.style.boxShadow='none'">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; color: #FFD700; font-weight: bold; font-size: 14px;">üì∏ Photo</label>
                            <input type="file" id="simplePhoto" accept="image/*" style="width: 100%; padding: 14px; border: 2px solid #067D62; border-radius: 8px; background: white; color: #232F3E; font-size: 14px; cursor: pointer;">
                        </div>
                        
                        <!-- Manager Section -->
                        <div style="background: rgba(6,125,98,0.1); padding: 20px; border-radius: 10px; border-left: 4px solid #067D62; margin-bottom: 20px;">
                            <h4 style="color: #067D62; margin: 0 0 15px 0; font-size: 16px;">üëî Manager Information (Optional)</h4>
                            
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 8px; color: white; font-size: 13px;">Manager Name</label>
                                <input type="text" id="simpleManagerName" placeholder="Enter Manager Name" style="width: 100%; padding: 12px; border: 2px solid #067D62; border-radius: 8px; background: white; color: #232F3E; font-size: 14px;">
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: white; font-size: 13px;">Manager Username</label>
                                    <input type="text" id="simpleManagerUsername" placeholder="Username" style="width: 100%; padding: 12px; border: 2px solid #067D62; border-radius: 8px; background: white; color: #232F3E; font-size: 14px;">
                                </div>
                                
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: white; font-size: 13px;">Manager Email</label>
                                    <input type="email" id="simpleManagerEmail" placeholder="Email" style="width: 100%; padding: 12px; border: 2px solid #067D62; border-radius: 8px; background: white; color: #232F3E; font-size: 14px;">
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(209,50,18,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #D13212; margin-bottom: 20px;">
                            <label style="display: flex; align-items: center; color: white; cursor: pointer; font-size: 15px;">
                                <input type="checkbox" id="simpleExcludeFromTables" onchange="toggleRequiredFields()" style="margin-right: 12px; width: 22px; height: 22px; cursor: pointer;">
                                <span style="font-weight: bold;">üö´ Exclude from Performance Tables</span>
                            </label>
                            <p style="font-size: 12px; color: #FFD700; margin: 8px 0 0 34px; line-height: 1.5;">üí° When checked, this employee won't appear in performance tables. Username and email become optional.</p>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button type="button" id="simpleSaveBtn" onclick="saveSimpleEmployee()" style="background: linear-gradient(135deg, #FF9900 0%, #FF6B00 100%); color: white; border: none; padding: 16px 40px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(255,153,0,0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255,153,0,0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255,153,0,0.4)'">üíæ Save Employee</button>
                            <button type="button" onclick="clearSimpleForm()" style="background: #37475A; color: white; border: 2px solid #FFD700; padding: 16px 40px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; transition: all 0.3s;" onmouseover="this.style.background='#232F3E'" onmouseout="this.style.background='#37475A'">üóëÔ∏è Clear Form</button>
                        </div>
                    </form>
                </div>
                
                <!-- Employee Directory -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border: 2px solid rgba(255,215,0,0.3);">
                    <h3 style="color: #FFD700; margin: 0 0 20px 0; font-size: 24px; text-align: center;">üìã Employee Directory</h3>
                    
                    <!-- Search -->
                    <div style="margin-bottom: 20px;">
                        <input type="text" id="employeeSearchInput" placeholder="üîç Search by name, badge ID, username, or email..." onkeyup="searchEmployees()" style="width: 100%; padding: 14px; border: 2px solid #FFD700; border-radius: 8px; background: white; color: #232F3E; font-size: 15px; transition: all 0.3s;" onfocus="this.style.borderColor='#FF9900'; this.style.boxShadow='0 0 10px rgba(255,215,0,0.3)'" onblur="this.style.borderColor='#FFD700'; this.style.boxShadow='none'">
                    </div>
                    
                    <!-- Employee List -->
                    <div id="simpleEmployeeList" style="max-height: 500px; overflow-y: auto; margin-bottom: 20px; padding-right: 10px;">
                        <p style="text-align: center; color: #FF9900; padding: 40px 20px; background: rgba(255,153,0,0.1); border-radius: 10px;">No employees added yet!</p>
                    </div>
                    
                    <!-- Count -->
                    <div style="text-align: center; margin-bottom: 20px; padding: 12px; background: rgba(255,215,0,0.1); border-radius: 8px; border: 2px solid #FFD700;">
                        <span id="simpleEmployeeCount" style="color: #FFD700; font-weight: bold; font-size: 18px;">Total: 0</span>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button onclick="exportEmployeesJSON()" style="background: #067D62; color: white; border: none; padding: 14px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: all 0.3s; box-shadow: 0 2px 8px rgba(6,125,98,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(6,125,98,0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(6,125,98,0.3)'">üì• Export Employees JSON</button>
                        
                        <button onclick="removeExcludedEmployeesFromAllTables()" style="background: #D13212; color: white; border: none; padding: 14px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: all 0.3s; box-shadow: 0 2px 8px rgba(209,50,18,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(209,50,18,0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(209,50,18,0.3)'">üßπ Remove Excluded from All Tables</button>
                    </div>
                    
                    <p style="color: #FFD700; font-size: 12px; margin-top: 15px; text-align: center; line-height: 1.6;">üí° <strong>Tip:</strong> Drag & drop exported JSON to main upload area to import employees</p>
                </div>
            </div>
        </div>
    </div>

    <!-- TOM Shout Outs Modal -->
    <div id="shoutOutModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 99999;">
        <div style="position: relative; width: 95%; max-width: 1400px; height: 90vh; margin: 5vh auto; background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); color: white; border-radius: 20px; box-shadow: 0 10px 50px rgba(255,153,0,0.5); display: flex; flex-direction: column; overflow: hidden;">
            
            <!-- Header -->
            <div style="padding: 30px 40px; border-bottom: 3px solid #FF9900; background: rgba(0,0,0,0.3);">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 style="color: #FF9900; margin: 0 0 10px 0; font-size: 36px;">üéâ TOM Shout Outs Generator</h2>
                        <p style="margin: 0; color: #FFD700; font-size: 14px;">‚ú® Celebrating your amazing team members with personalized recognition!</p>
                    </div>
                    <span onclick="closeShoutOutModal()" style="cursor: pointer; font-size: 48px; color: #FF9900; line-height: 1; transition: transform 0.2s;" onmouseover="this.style.transform='rotate(90deg)'" onmouseout="this.style.transform='rotate(0deg)'">&times;</span>
                </div>
                
            </div>
            
            <!-- Shout Outs Panel (existing content) -->
            <div id="shoutOutsPanel" style="display: flex; flex-direction: column; flex: 1;">
            <!-- Controls -->
            <div style="padding: 20px 40px; background: rgba(0,0,0,0.2); border-bottom: 2px solid rgba(255,153,0,0.3);">
                <!-- Search Bar -->
                <div style="margin-bottom: 15px;">
                    <input type="text" id="shoutOutSearch" placeholder="üîç Search by associate name..." onkeyup="searchShoutOuts()" style="width: 100%; padding: 12px 20px; border: 2px solid #FF9900; border-radius: 8px; background: white; color: #232F3E; font-size: 15px; font-weight: bold;">
                </div>
                
                <!-- Navigation Controls -->
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button onclick="previousPage()" id="prevBtn" style="background: #37475A; color: white; border: 2px solid #FF9900; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: all 0.3s;" onmouseover="this.style.background='#FF9900'" onmouseout="this.style.background='#37475A'">‚¨ÖÔ∏è Previous</button>
                        <button onclick="nextPage()" id="nextBtn" style="background: #37475A; color: white; border: 2px solid #FF9900; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: all 0.3s;" onmouseover="this.style.background='#FF9900'" onmouseout="this.style.background='#37475A'">Next ‚û°Ô∏è</button>
                    </div>
                    
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button onclick="clearShoutOutSearch()" style="background: #232F3E; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: all 0.3s;" onmouseover="this.style.background='#37475A'" onmouseout="this.style.background='#232F3E'">üîÑ Show All</button>
                        <button onclick="generateShoutOuts()" style="background: #067D62; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: all 0.3s; box-shadow: 0 4px 15px rgba(6,125,98,0.4);" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">üîÑ Regenerate</button>
                        <button onclick="copyAllShoutOuts()" style="background: #FF9900; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: all 0.3s; box-shadow: 0 4px 15px rgba(255,153,0,0.4);" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">üìã Copy All</button>
                        <div style="background: rgba(255,153,0,0.2); padding: 12px 24px; border-radius: 8px; border: 2px solid #FF9900;">
                            <span style="color: #FFD700; font-weight: bold; font-size: 16px;">Page <span id="currentPage">1</span> of <span id="totalPages">1</span></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Shout Outs Grid Container -->
            <div id="shoutOutContainer" style="flex: 1; overflow-y: auto; padding: 30px 40px;">
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="font-size: 64px; margin-bottom: 20px; animation: bounce 2s infinite;">üéâ</div>
                    <p style="color: #FFD700; font-size: 20px; margin: 0;">Loading amazing shout outs...</p>
                </div>
            </div>
            
            <!-- Footer Stats -->
            <div style="padding: 15px 40px; background: rgba(0,0,0,0.3); border-top: 2px solid rgba(255,153,0,0.3); display: flex; justify-content: space-between; align-items: center;">
                <div style="color: #FFD700; font-size: 13px;">
                    <span id="shoutOutStats">üìä Generating shout outs...</span>
                </div>
                <div style="color: #ccc; font-size: 12px;">
                    üí° Tip: Use Previous/Next to browse ‚Ä¢ Click Copy to share individual shout outs
                </div>
            </div>
            </div>
        </div>
    </div>
    


    <!-- Team Intelligence Hub Modal -->
    <div id="teamIntelligenceModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 99999; overflow-y: auto;">
        <div style="position: relative; max-width: 1600px; margin: 20px auto; background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); color: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 50px rgba(255,153,0,0.4); border: 3px solid #FFD700;">
            
            <!-- Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 3px solid #FFD700; padding-bottom: 20px;">
                <div style="flex: 1;">
                    <h2 style="color: #FFD700; margin: 0; font-size: 36px;">üß† TOM Insight Hub</h2>
                    <p style="color: #FF9900; margin: 5px 0 0 0; font-size: 14px;">Advanced Analytics ‚Ä¢ Predictive Insights ‚Ä¢ Amazon Leadership Principles</p>
                    <p id="lastUpdated" style="color: #ccc; margin: 5px 0 0 0; font-size: 12px;">Last Updated: <span id="lastUpdatedTime">--</span></p>
                </div>
                <span onclick="closeTeamIntelligenceHub()" style="cursor: pointer; font-size: 40px; color: #FFD700; line-height: 1;">&times;</span>
            </div>
            
            <!-- Executive Summary -->
            <div id="executiveSummary" style="background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid #FF9900;">
                <h3 style="color: #FF9900; margin: 0 0 15px 0; font-size: 20px;">üìã Executive Summary</h3>
                <div id="executiveSummaryContent" style="color: white; font-size: 15px; line-height: 1.8;">
                    Generating executive summary...
                </div>
            </div>

            <!-- Controls -->
            <div style="display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap;">
                <button onclick="refreshIntelligence()" style="background: #FF9900; color: white; border: 2px solid #FFD700; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold;">üîÑ Refresh Analytics</button>
                <select id="timePeriodFilter" onchange="applyTimePeriodFilter()" style="padding: 12px; border: 2px solid #FFD700; border-radius: 8px; background: white; color: #232F3E; font-weight: bold;">
                    <option value="7">Last 7 Days</option>
                    <option value="30" selected>Last 30 Days</option>
                    <option value="90">Last 90 Days</option>
                    <option value="all">All Time</option>
                </select>
                <button onclick="exportIntelligenceReport()" style="background: #067D62; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold;">üìÑ Export Report</button>
                <button onclick="exportToPowerPoint()" style="background: #D13212; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold;">üìä Export to PowerPoint</button>
            </div>

            <!-- Team Health Score -->
            <div id="teamHealthScore" style="background: linear-gradient(135deg, #FF9900 0%, #FF6B00 100%); padding: 30px; border-radius: 15px; margin-bottom: 30px; text-align: center; border: 3px solid #FFD700; box-shadow: 0 8px 20px rgba(255,153,0,0.3);">
                <h3 style="color: white; margin: 0 0 15px 0; font-size: 24px;">Overall Team Health Score</h3>
                <div id="healthScoreValue" style="font-size: 72px; font-weight: bold; color: white; margin: 20px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">--</div>
                <div id="healthScoreCategory" style="font-size: 24px; color: white; margin-bottom: 10px;">Calculating...</div>
                <div id="healthScoreTrend" style="font-size: 18px; color: white;">--</div>
                <div id="healthScoreChart" style="margin-top: 20px; height: 200px;">
                    <canvas id="healthScoreSparkline"></canvas>
                </div>
            </div>

            <!-- Strategic Questions for Leadership -->
            <div style="background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid #FF9900;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #FF9900; margin: 0; font-size: 22px;">üí° Strategic Questions for Leadership</h3>
                    <button onclick="generateNewQuestions()" style="background: #FFD700; color: #232F3E; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px;">üîÑ New Questions</button>
                </div>
                <p style="color: #FFD700; font-size: 13px; margin-bottom: 15px;">Thousands of AI-generated questions to help you think deeper and lead better</p>
                <div id="strategicQuestions" style="display: flex; flex-direction: column; gap: 15px;">
                    <div style="background: rgba(255,153,0,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #FF9900;">
                        <p style="color: white; font-size: 15px; margin: 0;">Generating strategic questions...</p>
                    </div>
                </div>
            </div>

            <!-- Main Content Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 25px;">
                
                <!-- Trends Analysis -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #067D62;">
                    <h3 style="color: #067D62; margin: 0 0 20px 0; font-size: 22px;">üìä Performance Trends</h3>
                    <canvas id="trendsChart" style="max-height: 300px; margin-bottom: 15px;"></canvas>
                    <div id="trendsContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Analyzing trends...</p>
                    </div>
                </div>

                <!-- Strengths -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #FFD700;">
                    <h3 style="color: #FFD700; margin: 0 0 20px 0; font-size: 22px;">üí™ Team Strengths</h3>
                    <div id="strengthsContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Identifying strengths...</p>
                    </div>
                </div>

                <!-- Growth Opportunities -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #FF9900;">
                    <h3 style="color: #FF9900; margin: 0 0 20px 0; font-size: 22px;">üìà Growth Opportunities</h3>
                    <div id="growthContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Analyzing growth areas...</p>
                    </div>
                </div>

                <!-- Predictive Alerts -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #D13212;">
                    <h3 style="color: #D13212; margin: 0 0 20px 0; font-size: 22px;">üîÆ Predictive Alerts</h3>
                    <div id="alertsContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Scanning for potential issues...</p>
                    </div>
                </div>

                <!-- Barriers & Solutions -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #FF9900;">
                    <h3 style="color: #FF9900; margin: 0 0 20px 0; font-size: 22px;">üöß Barriers & Solutions</h3>
                    <div id="barriersContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Identifying barriers...</p>
                    </div>
                </div>

                <!-- Team Composition -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #FFD700;">
                    <h3 style="color: #FFD700; margin: 0 0 20px 0; font-size: 22px;">üë• Team Composition</h3>
                    <canvas id="compositionChart" style="max-height: 250px; margin-bottom: 15px;"></canvas>
                    <div id="compositionContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Analyzing team distribution...</p>
                    </div>
                </div>

                <!-- Performance Relationships -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #FEBD69;">
                    <h3 style="color: #FEBD69; margin: 0 0 20px 0; font-size: 22px;">üß© Performance Relationships</h3>
                    <div id="correlationsContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Calculating correlations...</p>
                    </div>
                </div>

                <!-- Performance Trajectory -->
                <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; border-left: 5px solid #067D62;">
                    <h3 style="color: #067D62; margin: 0 0 20px 0; font-size: 22px;">üìâ Performance Trajectory</h3>
                    <canvas id="trajectoryChart" style="max-height: 300px; margin-bottom: 15px;"></canvas>
                    <div id="trajectoryContent" style="color: white;">
                        <p style="text-align: center; color: #ccc; padding: 20px;">Projecting future performance...</p>
                    </div>
                </div>

            </div>

            <!-- Leadership Principles Section -->
            <div style="background: rgba(255,255,255,0.05); padding: 30px; border-radius: 15px; margin-top: 30px; border: 2px solid #FFD700;">
                <h3 style="color: #FFD700; margin: 0 0 25px 0; font-size: 24px; text-align: center;">üéØ Amazon Leadership Principles Alignment</h3>
                <div id="leadershipPrinciplesContent" style="color: white;">
                    <p style="text-align: center; color: #ccc; padding: 20px;">Calculating principle alignment...</p>
                </div>
            </div>

            <!-- Priority Actions -->
            <div style="background: linear-gradient(135deg, #37475A 0%, #232F3E 100%); padding: 30px; border-radius: 15px; margin-top: 30px; border: 2px solid #FFD700; box-shadow: 0 4px 15px rgba(255,215,0,0.2);">
                <h3 style="color: #FFD700; margin: 0 0 25px 0; font-size: 24px; text-align: center;">‚ö° Priority Actions</h3>
                <div id="priorityActionsContent" style="color: white;">
                    <p style="text-align: center; color: white; padding: 20px;">Generating recommendations...</p>
                </div>
            </div>

        </div>
    </div>

    <!-- Certificate Generator Modal -->
    <div id="certificateModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 99999; overflow-y: auto;">
        <div style="position: relative; max-width: 1200px; margin: 30px auto; background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); color: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 50px rgba(255,215,0,0.5); border: 3px solid #FFD700;">
            
            <!-- Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 3px solid #FFD700; padding-bottom: 20px;">
                <div>
                    <h2 style="color: #FFD700; margin: 0; font-size: 36px;">üèÜ Achievement Certificate Generator</h2>
                    <p style="color: #FF9900; margin: 5px 0 0 0; font-size: 14px;">Create professional, printable certificates with Amazon Leadership Principles</p>
                </div>
                <span onclick="closeCertificateModal()" style="cursor: pointer; font-size: 40px; color: #FFD700; line-height: 1; transition: transform 0.2s;" onmouseover="this.style.transform='rotate(90deg)'" onmouseout="this.style.transform='rotate(0deg)'">&times;</span>
            </div>
            
            <!-- Selection Panel -->
            <div style="background: rgba(255,215,0,0.1); padding: 30px; border-radius: 15px; border-left: 5px solid #FFD700; margin-bottom: 30px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
                    <!-- Employee Selection -->
                    <div>
                        <label style="display: block; color: #FFD700; font-size: 18px; font-weight: bold; margin-bottom: 15px;">üë§ Select Employee:</label>
                        <select id="certificateEmployeeSelect" style="width: 100%; padding: 15px; border: 2px solid #FFD700; border-radius: 10px; background: white; color: #232F3E; font-size: 16px; font-weight: bold; cursor: pointer;">
                            <option value="">-- Select Employee --</option>
                        </select>
                    </div>
                    
                    <!-- Award Type Selection -->
                    <div>
                        <label style="display: block; color: #FFD700; font-size: 18px; font-weight: bold; margin-bottom: 15px;">üèÖ Award Type:</label>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <label style="display: flex; align-items: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s;" onmouseover="this.style.borderColor='#FFD700'" onmouseout="this.style.borderColor='transparent'">
                                <input type="radio" name="awardType" value="driver" style="width: 20px; height: 20px; margin-right: 15px; cursor: pointer;">
                                <span style="font-size: 16px; font-weight: bold;">üöó Driver of the Month</span>
                            </label>
                            <label style="display: flex; align-items: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s;" onmouseover="this.style.borderColor='#FFD700'" onmouseout="this.style.borderColor='transparent'">
                                <input type="radio" name="awardType" value="employee" style="width: 20px; height: 20px; margin-right: 15px; cursor: pointer;">
                                <span style="font-size: 16px; font-weight: bold;">‚≠ê Employee of the Month</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <button onclick="generateCertificate()" style="width: 100%; background: linear-gradient(135deg, #FF9900 0%, #FF6B00 100%); color: white; border: none; padding: 18px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 18px; box-shadow: 0 4px 15px rgba(255,153,0,0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255,153,0,0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255,153,0,0.4)'">
                    ‚ú® Generate Certificate
                </button>
            </div>
            
            <!-- Certificate Display -->
            <div id="certificateDisplay" style="background: white; padding: 40px; border-radius: 15px; min-height: 400px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
                <div style="text-align: center; padding: 100px 20px; color: #999;">
                    <div style="font-size: 80px; margin-bottom: 20px;">üèÜ</div>
                    <h3 style="color: #FFD700; margin-bottom: 10px;">Ready to Create a Certificate</h3>
                    <p style="color: #666;">Select an employee and award type above, then click Generate Certificate</p>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div id="certificateActions" style="display: none; margin-top: 30px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <button onclick="printCertificate()" style="background: #067D62; color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(6,125,98,0.3); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    üñ®Ô∏è Print Certificate
                </button>
                <button onclick="downloadCertificatePDF()" style="background: #D13212; color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(209,50,18,0.3); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    üìÑ Download PDF
                </button>
                <button onclick="downloadCertificateImage()" style="background: #2B5797; color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(43,87,151,0.3); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    üñºÔ∏è Download Image
                </button>
                <button onclick="resetCertificate()" style="background: #37475A; color: white; border: 2px solid #FFD700; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; transition: all 0.3s;" onmouseover="this.style.background='#232F3E'" onmouseout="this.style.background='#37475A'">
                    üîÑ Generate Another
                </button>
            </div>
            
        </div>
    </div>

    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            #certificateContent, #certificateContent *,
            #conversationGuideContainer, #conversationGuideContainer * {
                visibility: visible;
            }
            #certificateContent,
            #conversationGuideContainer {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                background: white !important;
                color: black !important;
                padding: 20px;
            }
            #conversationGuideContainer h2,
            #conversationGuideContainer h3,
            #conversationGuideContainer h4 {
                color: #000 !important;
                page-break-after: avoid;
                margin-top: 20px;
                margin-bottom: 10px;
            }
            #conversationGuideContainer h2 {
                font-size: 24px;
                border-bottom: 3px solid #FF9900;
                padding-bottom: 10px;
            }
            #conversationGuideContainer h3 {
                font-size: 20px;
                border-bottom: 2px solid #FFD700;
                padding-bottom: 8px;
            }
            #conversationGuideContainer h4 {
                font-size: 16px;
                font-weight: bold;
            }
            #conversationGuideContainer p,
            #conversationGuideContainer div {
                color: #000 !important;
                background: transparent !important;
                border-color: #ccc !important;
            }
            #conversationGuideContainer ul,
            #conversationGuideContainer ol {
                margin-left: 20px;
                page-break-inside: avoid;
            }
            #conversationGuideContainer li {
                margin-bottom: 8px;
                color: #000 !important;
            }
            #conversationGuideContainer button {
                display: none !important;
            }
            #conversationGuideContainer > div {
                page-break-inside: avoid;
            }
            @page {
                margin: 0.75in;
                size: letter;
            }
        }
        
        .certificate-container {
            width: 8.5in;
            height: 11in;
            margin: 0 auto;
            background: white;
            position: relative;
        }
        
        .certificate-border {
            border: 15px solid #FF9900;
            border-image: linear-gradient(135deg, #FFD700, #FF9900, #FFD700) 1;
            padding: 40px;
            height: 100%;
            box-sizing: border-box;
            position: relative;
        }
        
        .certificate-border::before {
            content: '';
            position: absolute;
            top: 25px;
            left: 25px;
            right: 25px;
            bottom: 25px;
            border: 2px solid #FFD700;
            pointer-events: none;
        }
    </style>

    <!-- Certificate Generator Modal -->
    <div id="certificateModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 99999; overflow-y: auto;">
        <div style="position: relative; max-width: 1200px; margin: 30px auto; background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); color: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 50px rgba(255,215,0,0.5); border: 3px solid #FFD700;">
            
            <!-- Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 3px solid #FFD700; padding-bottom: 20px;">
                <div>
                    <h2 style="color: #FFD700; margin: 0; font-size: 36px;">üèÜ Achievement Certificate Generator</h2>
                    <p style="color: #FF9900; margin: 5px 0 0 0; font-size: 14px;">Create professional, printable certificates with Amazon Leadership Principles</p>
                </div>
                <span onclick="closeCertificateModal()" style="cursor: pointer; font-size: 40px; color: #FFD700; line-height: 1; transition: transform 0.2s;" onmouseover="this.style.transform='rotate(90deg)'" onmouseout="this.style.transform='rotate(0deg)'">&times;</span>
            </div>
            
            <!-- Selection Panel -->
            <div style="background: rgba(255,215,0,0.1); padding: 30px; border-radius: 15px; border-left: 5px solid #FFD700; margin-bottom: 30px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
                    <!-- Employee Selection -->
                    <div>
                        <label style="display: block; color: #FFD700; font-size: 18px; font-weight: bold; margin-bottom: 15px;">üë§ Select Employee:</label>
                        <select id="certificateEmployeeSelect" style="width: 100%; padding: 15px; border: 2px solid #FFD700; border-radius: 10px; background: white; color: #232F3E; font-size: 16px; font-weight: bold; cursor: pointer;">
                            <option value="">-- Select Employee --</option>
                        </select>
                    </div>
                    
                    <!-- Award Type Selection -->
                    <div>
                        <label style="display: block; color: #FFD700; font-size: 18px; font-weight: bold; margin-bottom: 15px;">üèÖ Award Type:</label>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <label style="display: flex; align-items: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s;" onmouseover="this.style.borderColor='#FFD700'" onmouseout="this.style.borderColor='transparent'">
                                <input type="radio" name="awardType" value="driver" style="width: 20px; height: 20px; margin-right: 15px; cursor: pointer;">
                                <span style="font-size: 16px; font-weight: bold;">üöó Driver of the Month</span>
                            </label>
                            <label style="display: flex; align-items: center; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s;" onmouseover="this.style.borderColor='#FFD700'" onmouseout="this.style.borderColor='transparent'">
                                <input type="radio" name="awardType" value="employee" style="width: 20px; height: 20px; margin-right: 15px; cursor: pointer;">
                                <span style="font-size: 16px; font-weight: bold;">‚≠ê Employee of the Month</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <button onclick="generateCertificate()" style="width: 100%; background: linear-gradient(135deg, #FF9900 0%, #FF6B00 100%); color: white; border: none; padding: 18px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 18px; box-shadow: 0 4px 15px rgba(255,153,0,0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255,153,0,0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255,153,0,0.4)'">
                    ‚ú® Generate Certificate
                </button>
            </div>
            
            <!-- Certificate Display -->
            <div id="certificateDisplay" style="background: white; padding: 40px; border-radius: 15px; min-height: 400px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
                <div style="text-align: center; padding: 100px 20px; color: #999;">
                    <div style="font-size: 80px; margin-bottom: 20px;">üèÜ</div>
                    <h3 style="color: #FFD700; margin-bottom: 10px;">Ready to Create a Certificate</h3>
                    <p style="color: #666;">Select an employee and award type above, then click Generate Certificate</p>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div id="certificateActions" style="display: none; margin-top: 30px; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <button onclick="printCertificate()" style="background: #067D62; color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(6,125,98,0.3); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    üñ®Ô∏è Print Certificate
                </button>
                <button onclick="downloadCertificatePDF()" style="background: #D13212; color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(209,50,18,0.3); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    üìÑ Download PDF
                </button>
                <button onclick="downloadCertificateImage()" style="background: #2B5797; color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; box-shadow: 0 4px 15px rgba(43,87,151,0.3); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    üñºÔ∏è Download Image
                </button>
                <button onclick="resetCertificate()" style="background: #37475A; color: white; border: 2px solid #FFD700; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 16px; transition: all 0.3s;" onmouseover="this.style.background='#232F3E'" onmouseout="this.style.background='#37475A'">
                    üîÑ Generate Another
                </button>
            </div>
            
        </div>
    </div>

    <!-- Simple 1:1 Thrive Modal -->
    <div id="oneOnOneModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
        <div style="max-width: 900px; margin: 50px auto; background: linear-gradient(135deg, #232F3E 0%, #37475A 100%); border-radius: 15px; padding: 40px; box-shadow: 0 10px 50px rgba(0,0,0,0.5);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2 style="color: #FFD700; margin: 0;">üí¨ 1:1 Thrive Conversation Guide</h2>
                <button onclick="closeOneOnOneModal()" style="background: #D13212; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold;">‚úï Close</button>
            </div>
            
            <!-- Employee Selection -->
            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 10px; margin-bottom: 20px;">
                <label style="display: block; color: #FFD700; font-size: 16px; font-weight: bold; margin-bottom: 15px;">Select Team Member:</label>
                <input type="text" id="employeeSearchBox" placeholder="Search by name..." style="width: 100%; padding: 12px; border: 2px solid #FFD700; border-radius: 8px; font-size: 16px; margin-bottom: 15px;" oninput="filterEmployeeList()">
                <div id="employeeListContainer" style="max-height: 300px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 10px;">
                    <p style="color: #999; text-align: center; padding: 20px;">Loading employees...</p>
                </div>
            </div>
            
            <!-- Conversation Guide Display -->
            <div id="conversationGuideContainer" style="background: rgba(255,255,255,0.05); padding: 30px; border-radius: 10px; color: white; min-height: 200px;">
                <p style="font-size: 16px; text-align: center; color: #999;">Select a team member above to generate their conversation guide</p>
            </div>
        </div>
    </div>

    <script>
    // Quick fix: Define openCertificateModal inline
    function openCertificateModal() {
        const modal = document.getElementById('certificateModal');
        if (modal) {
            modal.style.display = 'block';
            if (typeof populateEmployeeDropdown === 'function') {
                populateEmployeeDropdown();
            }
        } else {
            console.error('Certificate modal not found. Please refresh the page.');
        }
    }
    
    // 1:1 Thrive Modal Functions
    function openOneOnOneModal() {
        document.getElementById('oneOnOneModal').style.display = 'block';
        loadEmployeeList();
    }
    
    function closeOneOnOneModal() {
        document.getElementById('oneOnOneModal').style.display = 'none';
    }
    
    function loadEmployeeList() {
        const container = document.getElementById('employeeListContainer');
        const employees = getAllUniqueEmployees();
        
        if (employees.length === 0) {
            container.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">No employees found. Please upload data first.</p>';
            return;
        }
        
        let html = '';
        employees.forEach(emp => {
            html += `<div onclick="selectEmployee('${emp.replace(/'/g, "\\'")}', this)" style="padding: 12px; margin: 5px 0; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer; transition: all 0.3s; border: 2px solid transparent;" onmouseover="this.style.background='rgba(255,215,0,0.2)'; this.style.borderColor='#FFD700'" onmouseout="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='transparent'">
                <span style="color: white; font-size: 15px;">üë§ ${emp}</span>
            </div>`;
        });
        container.innerHTML = html;
    }
    
    function getAllUniqueEmployees() {
        const employees = new Set();
        
        // Get data from all dashboards
        if (typeof dashboards !== 'undefined') {
            const dashboardKeys = ['tableBody', 'tableBody2', 'tableBody3', 'tableBody4', 'tableBody5', 'tableBody6'];
            dashboardKeys.forEach(key => {
                const dashboard = dashboards[key];
                if (dashboard && dashboard.data && Array.isArray(dashboard.data)) {
                    dashboard.data.forEach(record => {
                        if (record.name) {
                            employees.add(record.name);
                        } else if (record.associateName) {
                            employees.add(record.associateName);
                        } else if (record['Associate Name']) {
                            employees.add(record['Associate Name']);
                        }
                    });
                }
            });
        }
        
        return Array.from(employees).sort();
    }
    
    function selectEmployee(name, element) {
        // Remove previous selection
        const container = document.getElementById('employeeListContainer');
        const items = container.getElementsByTagName('div');
        for (let item of items) {
            item.style.background = 'rgba(255,255,255,0.1)';
            item.style.borderColor = 'transparent';
        }
        
        // Highlight selected
        element.style.background = 'rgba(255,215,0,0.3)';
        element.style.borderColor = '#FFD700';
        
        // Show conversation guide
        const guideContainer = document.getElementById('conversationGuideContainer');
        guideContainer.innerHTML = `
            <div style="text-align: center; padding: 40px;">
                <h3 style="color: #FFD700; margin-bottom: 20px;">Conversation Guide for ${name}</h3>
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; text-align: left; margin-top: 20px;">
                    <h4 style="color: #FFD700; margin-bottom: 15px;">üéØ Opening Questions:</h4>
                    <p style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">"How are things going for you this week?"</p>
                    <p style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">"What's been your biggest win recently?"</p>
                    <p style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">"Is there anything blocking your progress?"</p>
                    
                    <h4 style="color: #FFD700; margin: 20px 0 15px 0;">üí° Development Topics:</h4>
                    <p style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">"What skills would you like to develop?"</p>
                    <p style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">"How can I better support you?"</p>
                </div>
            </div>
        `;
    }
    
    function filterEmployeeList() {
        const searchBox = document.getElementById('employeeSearchBox');
        const filter = searchBox.value.toLowerCase();
        const container = document.getElementById('employeeListContainer');
        const items = container.getElementsByTagName('div');
        
        for (let item of items) {
            const text = item.textContent.toLowerCase();
            if (text.includes(filter)) {
                item.style.display = '';
            } else {
                item.style.display = 'none';
            }
        }
    }
    </script>
    
    <!-- Table Configuration Manager Modal -->
    <div id="tableConfigModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow-y: auto; display: none; background: rgba(0,0,0,0.8); z-index: 10000;">
        <div style="max-width: 1400px; width: 95%; margin: 30px auto 30px auto; background: #1a1a2e; border-radius: 10px; padding: 0;">
            <div class="modal-header">
                <h2>‚öôÔ∏è Table Configuration Manager</h2>
                <span class="close" onclick="closeTableConfigModal()">&times;</span>
            </div>
            <div class="modal-body">
                <!-- Add New Table Button -->
                <div style="margin-bottom: 20px;">
                    <button class="btn-primary" onclick="showAddTableForm()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
                        ‚ûï Add New Table
                    </button>
                </div>

                <!-- Add/Edit Table Form (Hidden by default) -->
                <div id="tableConfigForm" style="display: none; background: #16213e; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 id="formTitle">Add New Table</h3>
                    <input type="hidden" id="editingTableKey" value="">
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Table Name:</label>
                            <input type="text" id="configTableName" placeholder="e.g., Andon Accepted Count" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Table ID:</label>
                            <input type="text" id="configTableId" placeholder="e.g., tableBody7" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">File Pattern:</label>
                            <input type="text" id="configFilePattern" placeholder="e.g., andon-accepted" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Username Column:</label>
                            <input type="text" id="configUsernameColumn" placeholder="e.g., T or 19" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Value Column:</label>
                            <input type="text" id="configValueColumn" placeholder="e.g., AE or 30" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Aggregation:</label>
                            <select id="configAggregation" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                                <option value="average">Average (for percentages, times)</option>
                                <option value="sum">Sum (for counts)</option>
                                <option value="none">None (single entry per user)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Direction:</label>
                            <select id="configDirection" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                                <option value="above">Above (higher is better)</option>
                                <option value="below">Below (lower is better)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Benchmark:</label>
                            <input type="number" id="configBenchmark" placeholder="e.g., 100 or 0" step="0.01" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Display Format:</label>
                            <select id="configDisplayFormat" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                                <option value="percentage">Percentage (93.45%)</option>
                                <option value="decimal">Decimal (5.23)</option>
                                <option value="integer">Integer (45)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #FFD700;">Include in Employee of the Month?</label>
                            <select id="configIncludeInLeaderboard" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #0f3460; background: #0f3460; color: white;">
                                <option value="true">Yes - Include in leaderboard</option>
                                <option value="false">No - Standalone table only</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; display: flex; gap: 10px;">
                        <button onclick="saveTableConfig()" style="background: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
                            üíæ Save Table
                        </button>
                        <button onclick="cancelTableForm()" style="background: #F44336; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
                            ‚ùå Cancel
                        </button>
                    </div>
                </div>

                <!-- Existing Tables List -->
                <div id="tableConfigList">
                    <h3>Configured Tables</h3>
                    <div id="tablesList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dynamic Tables Container -->
    <div id="tables-container" style="margin-top: 40px;">
        <!-- Dynamically generated tables will be inserted here -->
    </div>

    <!-- SheetJS library for Excel processing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Chart.js for interactive charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- html2canvas for image export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- html2pdf for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- Supabase for authentication and database -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Dynamic cache busting - automatically loads latest files -->
    <script>document.write('<script src="js/script-clean.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/benchmark-modal.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/universal-benchmark.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/ppo-edit.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/vti-dpmo-edit.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/simple-employee.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/shout-outs.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/auto-refresh.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/filter-excluded.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/manual-refresh.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/certificate-generator-v2.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/verbiage-generator-standalone.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/unified-leaderboard.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/load-certificate-modal.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/shout-out-verbiage-generator.js?v=' + cacheBuster + '"><\/script>');</script>
    
    <!-- Dynamic Table Configuration System -->
    <script>document.write('<script src="js/table-config-system.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/file-routing-engine.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/dynamic-table-generator.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/dashboard-manager.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/config-modal.js?v=' + cacheBuster + '"><\/script>');</script>
    
    <!-- Database Integration -->
    <script>document.write('<script src="js/auth-service.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/database-service.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/dashboard-database-adapter.js?v=' + cacheBuster + '"><\/script>');</script>
    <script>document.write('<script src="js/dashboard-init.js?v=' + cacheBuster + '"><\/script>');</script>
    
    <!-- Initialize Config Modal -->
    <script>
        // Update user info display
        function updateUserInfoDisplay() {
            const userInfoSection = document.getElementById('userInfoSection');
            const userEmail = document.getElementById('userEmail');
            const userRole = document.getElementById('userRole');
            
            if (typeof isAuthenticated === 'function' && isAuthenticated()) {
                const user = getCurrentUser();
                if (user) {
                    userEmail.textContent = user.email;
                    userRole.textContent = user.role.replace('_', ' ').toUpperCase();
                    userInfoSection.style.display = 'block';
                }
            } else {
                userInfoSection.style.display = 'none';
            }
        }
        
        // Initialize config modal when page loads
        window.addEventListener('DOMContentLoaded', async function() {
            if (typeof TableConfigSystem !== 'undefined' && typeof DashboardManager !== 'undefined') {
                // These will be initialized by the main application
                console.log('Config modal system loaded');
            }
            
            // Initialize database integration
            if (typeof initializeDashboardWithDatabase !== 'undefined') {
                console.log('üîÑ Initializing database integration...');
                const dbInitialized = await initializeDashboardWithDatabase();
                
                if (dbInitialized) {
                    console.log('‚úÖ Database initialized successfully');
                    
                    // Update user info display
                    updateUserInfoDisplay();
                    
                    // Wait for dashboards to be created, then integrate
                    setTimeout(async () => {
                        if (window.dashboards && Object.keys(window.dashboards).length > 0) {
                            await integrateDatabaseWithDashboards();
                            console.log('‚úÖ Database integration complete');
                        } else {
                            console.log('‚ö†Ô∏è No dashboards found, skipping database integration');
                        }
                    }, 1000);
                } else {
                    console.log('‚ö†Ô∏è Database not initialized, using localStorage mode');
                }
            }
        });
    </script>

</body>
</html>